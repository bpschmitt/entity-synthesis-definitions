domain: EXT
type: OTEL_COLLECTOR

synthesis:
  rules:
  # OTel Collector telemetry with k8sattributes
  - compositeIdentifier:
      separator: ":"
      attributes:
        - k8s.pod.name
        - k8s.namespace.name
        - k8s.cluster.name
    name: k8s.pod.name
    encodeIdentifierInGUID: true
    conditions:
    - attribute: metricName
      prefix: otelcol_
    - attribute: k8s.namespace.name
      present: true
    - attribute: k8s.cluster.name
      present: true
    - attribute: k8s.pod.name
      present: true
    # added for testing
    - attribute: attributeForTesting
      present: true
  tags:
    instrumentation.provider:
    instrumentation.name:
    k8s.cluster.name:
    k8s.namespace.name:
  # TO-DO: add rule for non-K8s environments

dashboardTemplates:
  newRelic:
    template: dashboard.json

configuration:
  entityExpirationTime: FOUR_HOURS
  alertable: true
